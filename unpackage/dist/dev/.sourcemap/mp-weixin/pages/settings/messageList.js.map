{"version":3,"file":"messageList.js","sources":["pages/settings/messageList.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2V0dGluZ3MvbWVzc2FnZUxpc3QudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 顶部标题栏 -->\r\n\r\n\t\t<view class=\"header\">\r\n\t\t\t<image class=\"back-icon\" src=\"/static/back.png\" @click=\"goBack\" />\r\n\t\t\t<text class=\"title\">消息</text>\r\n\t\t\t<view class=\"mark-all\" @click=\"markAllAsRead\">全部已读</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 消息列表 -->\r\n\t\t<scroll-view scroll-y class=\"message-scroll\">\r\n\t\t\t<view v-for=\"(msg, index) in messages\" :key=\"msg.id\" class=\"swipe-wrapper\"\r\n\t\t\t\t:class=\"{ swiped: swipedIndex === index }\" @touchstart=\"touchStart($event, index)\"\r\n\t\t\t\t@touchmove=\"touchMove($event, index)\" @touchend=\"touchEnd\">\r\n\t\t\t\t<!-- 删除按钮：与 .message-item 同级，跟随 .swipe-wrapper 一起平移 -->\r\n\t\t\t\t<view class=\"delete-button\" @click.stop=\"deleteMessage(index)\">\r\n\t\t\t\t\t删除\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 消息卡片 -->\r\n\t\t\t\t<view class=\"message-item\" @click=\"toggleExpand(index)\">\r\n\t\t\t\t\t<view class=\"message-header\">\r\n\t\t\t\t\t\t<view class=\"base-item\">\r\n\t\t\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t\t\t<text class=\"message-title\">{{ msg.title }}</text>\r\n\t\t\t\t\t\t\t\t<view v-if=\"!msg.read\" class=\"unread-dot\" />\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"time\">{{ msg.time }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"message-content\" v-if=\"msg.expanded\">\r\n\t\t\t\t\t\t<text>{{ msg.content }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmessages: [{\r\n\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\ttitle: '欢迎使用衣橱管家！',\r\n\t\t\t\t\t\tcontent: '这是您的第一条站内信，感谢您的使用，让我们一起进入精致的生活吧。',\r\n\t\t\t\t\t\ttime: '2025-06-11 10:00',\r\n\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\texpanded: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 2,\r\n\t\t\t\t\t\ttitle: '容量即将用尽',\r\n\t\t\t\t\t\tcontent: '您的搭配容量已不足 10%，请及时清理或升级。',\r\n\t\t\t\t\t\ttime: '2025-05-12 18:30',\r\n\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\texpanded: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 3,\r\n\t\t\t\t\t\ttitle: '功能更新通知',\r\n\t\t\t\t\t\tcontent: '新增类目编辑功能和主题设置界面，欢迎体验！',\r\n\t\t\t\t\t\ttime: '2025-05-10 14:20',\r\n\t\t\t\t\t\tread: false,\r\n\t\t\t\t\t\texpanded: false\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tstartX: 0,\r\n\t\t\t\tswipedIndex: -1,\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttoggleExpand(index) {\r\n\t\t\t\tconst msg = this.messages[index];\r\n\t\t\t\tmsg.expanded = !msg.expanded;\r\n\t\t\t\tif (msg.expanded) {\r\n\t\t\t\t\tmsg.read = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmarkAllAsRead() {\r\n\t\t\t\tthis.messages.forEach(msg => (msg.read = true));\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '全部标记为已读',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tdeleteMessage(index) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '确认删除',\r\n\t\t\t\t\tcontent: '确定要删除这条消息吗？',\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\tthis.messages.splice(index, 1);\r\n\t\t\t\t\t\t\tthis.swipedIndex = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttouchStart(e, index) {\r\n\t\t\t\tthis.startX = e.touches[0].clientX;\r\n\t\t\t\t// 先收起其他项\r\n\t\t\t\tif (this.swipedIndex !== index) {\r\n\t\t\t\t\tthis.swipedIndex = -1;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttouchMove(e, index) {\r\n\t\t\t\tconst moveX = e.touches[0].clientX;\r\n\t\t\t\tconst deltaX = this.startX - moveX;\r\n\t\t\t\t// 左滑超过 40px 展开当前项\r\n\t\t\t\tif (deltaX > 40) {\r\n\t\t\t\t\tthis.swipedIndex = index;\r\n\t\t\t\t}\r\n\t\t\t\t// 右滑超过 40px 收起\r\n\t\t\t\telse if (deltaX < -40) {\r\n\t\t\t\t\tthis.swipedIndex = -1;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttouchEnd() {\r\n\t\t\t\t// 结束时，无需额外处理\r\n\t\t\t},\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100vh;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\r\n\t.header {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 12px 20px;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-bottom: 1px solid #e5e5e5;\r\n\r\n\t\tpadding-top: calc(var(--status-bar-height) + 40px);\r\n\t}\r\n\r\n\t.back-icon {\r\n\t\twidth: 24px;\r\n\t\theight: 24px;\r\n\t\tmargin-right: 12px;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.mark-all {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #4b60d5b3;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.message-scroll {\r\n\t\tflex: 1;\r\n\t\tpadding: 10px 0;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t/* 滑动容器，统一平移 .swipe-wrapper，里面的按钮和卡片一起动 */\r\n\t.swipe-wrapper {\r\n\t\tposition: relative;\r\n\r\n\t\tmargin-bottom: 10px;\r\n\t\ttransition: transform 0.2s ease-in-out;\r\n\r\n\t}\r\n\r\n\t/* 平移距离等于删除按钮宽度 */\r\n\t.swipe-wrapper.swiped {\r\n\t\ttransform: translateX(-80px);\r\n\t}\r\n\r\n\t/* 删除按钮 */\r\n\t.delete-button {\r\n\t\tposition: absolute;\r\n\t\tright: -80px;\r\n\t\ttop: 0;\r\n\t\tbottom: 0;\r\n\t\twidth: 80px;\r\n\t\tbackground-color: #be2c2c;\r\n\t\tcolor: white;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tfont-size: 16px;\r\n\t\tz-index: 1;\r\n\t\tborder-top-left-radius: 10px;\r\n\t\tborder-bottom-left-radius: 10px;\r\n\t}\r\n\r\n\t/* 消息卡片 */\r\n\t.message-item {\r\n\t\tbackground: #ffffff;\r\n\t\tborder-radius: 10px;\r\n\t\tpadding: 12px 0;\r\n\t\tmargin: 0 10px;\r\n\t\tbox-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n\t\t/* 不再需要 transform 了 */\r\n\t}\r\n\r\n\t.message-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.base-item {\r\n\t\twidth: 100vw;\r\n\t}\r\n\r\n\t.left {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.message-title {\r\n\t\tfont-weight: bold;\r\n\t\tfont-size: 16px;\r\n\t\tmargin-right: 6px;\r\n\t}\r\n\r\n\t.unread-dot {\r\n\t\twidth: 8px;\r\n\t\theight: 8px;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #ff3b30;\r\n\t}\r\n\r\n\t.time {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.message-content {\r\n\t\tmargin-top: 10px;\r\n\t\tcolor: #333;\r\n\t\tline-height: 20px;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/GitProject/uniappWardrobe/pages/settings/messageList.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AAyCC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,QAAC;AAAA,UACT,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,SAAS;AAAA,UACT,MAAM;AAAA,UACN,MAAM;AAAA,UACN,UAAU;AAAA,QACV;AAAA,QACD;AAAA,UACC,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,SAAS;AAAA,UACT,MAAM;AAAA,UACN,MAAM;AAAA,UACN,UAAU;AAAA,QACV;AAAA,QACD;AAAA,UACC,IAAI;AAAA,UACJ,OAAO;AAAA,UACP,SAAS;AAAA,UACT,MAAM;AAAA,UACN,MAAM;AAAA,UACN,UAAU;AAAA,QACV;AAAA,MACD;AAAA,MACD,QAAQ;AAAA,MACR,aAAa;AAAA;EAEd;AAAA,EACD,SAAS;AAAA,IACR,aAAa,OAAO;AACnB,YAAM,MAAM,KAAK,SAAS,KAAK;AAC/B,UAAI,WAAW,CAAC,IAAI;AACpB,UAAI,IAAI,UAAU;AACjB,YAAI,OAAO;AAAA,MACZ;AAAA,IACA;AAAA,IACD,gBAAgB;AACf,WAAK,SAAS,QAAQ,SAAQ,IAAI,OAAO,IAAK;AAC9CA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AAAA,IACD;AAAA,IACD,cAAc,OAAO;AACpBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,SAAO;AACf,cAAI,IAAI,SAAS;AAChB,iBAAK,SAAS,OAAO,OAAO,CAAC;AAC7B,iBAAK,cAAc;AAAA,UACpB;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACD;AAAA,IACD,WAAW,GAAG,OAAO;AACpB,WAAK,SAAS,EAAE,QAAQ,CAAC,EAAE;AAE3B,UAAI,KAAK,gBAAgB,OAAO;AAC/B,aAAK,cAAc;AAAA,MACpB;AAAA,IACA;AAAA,IACD,UAAU,GAAG,OAAO;AACnB,YAAM,QAAQ,EAAE,QAAQ,CAAC,EAAE;AAC3B,YAAM,SAAS,KAAK,SAAS;AAE7B,UAAI,SAAS,IAAI;AAChB,aAAK,cAAc;AAAA,MACpB,WAES,SAAS,KAAK;AACtB,aAAK,cAAc;AAAA,MACpB;AAAA,IACA;AAAA,IACD,WAAW;AAAA,IAEV;AAAA,IACD,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,EACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5HH,GAAG,WAAW,eAAe;"}