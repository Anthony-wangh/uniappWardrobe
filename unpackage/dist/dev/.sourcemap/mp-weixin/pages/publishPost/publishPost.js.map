{"version":3,"file":"publishPost.js","sources":["pages/publishPost/publishPost.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHVibGlzaFBvc3QvcHVibGlzaFBvc3QudnVl"],"sourcesContent":["<!-- PublishPost.vue -->\r\n<template>\r\n\t<view class=\"publish-container\">\r\n\t\t<!-- Header -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<image class=\"back-btn\" src=\"/static/back.png\" @click=\"goBack\">‹</image>\r\n\t\t\t<text class=\"header-title\">发布动态</text>\r\n\t\t\t<text class=\"header-empty\"></text>\r\n\t\t</view>\r\n\r\n\t\t<!-- Publish Form -->\r\n\t\t<scroll-view class=\"publish-section\" scroll-y>\r\n\r\n\t\t\t<!-- 图片选择 -->\r\n\t\t\t<view class=\"image-picker\">\r\n\t\t\t\t<view v-for=\"(img, idx) in newPost.images\" :key=\"idx\" class=\"picked-image-wrapper\">\r\n\t\t\t\t\t<image :src=\"img\" class=\"picked-image\" mode=\"aspectFill\" />\r\n\t\t\t\t\t<text class=\"remove-btn\" @click=\"removeImage(idx)\">×</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"newPost.images.length < 9\" class=\"add-image-btn\" @click=\"chooseImage\">\r\n\t\t\t\t\t+\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\r\n\t\t\t<!-- 标题输入 -->\r\n\t\t\t<input v-model=\"newPost.title\" placeholder=\"添加标题 (可选)\" class=\"publish-title\" maxlength=\"50\" />\r\n\r\n\t\t\t<!-- 内容输入 -->\r\n\t\t\t<textarea v-model=\"newPost.content\" placeholder=\"说点什么...\" class=\"publish-input\" autoHeight />\r\n\r\n\t\t\t<!-- 发布按钮 -->\r\n\t\t\t<button class=\"publish-btn\" @click=\"publishPost\" :style=\"{ background: theme.primaryColor }\">\r\n\t\t\t\t发布\r\n\t\t\t</button>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tthemes\r\n\t} from '@/components/theme.js';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tnewPost: {\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tuser: '我',\r\n\t\t\t\t\tavatar: '',\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: '',\r\n\t\t\t\t\timages: [],\r\n\t\t\t\t\tlikeCount: 0,\r\n\t\t\t\t\tcommentCount: 0,\r\n\t\t\t\t\tliked: false,\r\n\t\t\t\t\tfavorited: false\r\n\t\t\t\t},\r\n\t\t\t\ttheme: themes[0],\r\n\t\t\t\tthemes\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.theme = uni.getStorageSync('theme') || this.themes[0];\r\n\t\t\t// 假设头像存储在用户信息中\r\n\t\t\tconst profile = uni.getStorageSync('userProfile') || {};\r\n\t\t\tthis.newPost.avatar = profile.avatar || '/static/tabBarIcons/personal.png';\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t},\r\n\t\t\tchooseImage() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 9 - this.newPost.images.length,\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tthis.newPost.images.push(...res.tempFilePaths);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tremoveImage(index) {\r\n\t\t\t\tthis.newPost.images.splice(index, 1);\r\n\t\t\t},\r\n\t\t\tpublishPost() {\r\n\t\t\t\tif (!this.newPost.content.trim() && this.newPost.images.length === 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入内容或选择图片',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// 生成唯一ID\r\n\t\t\t\tthis.newPost.id = Date.now().toString();\r\n\t\t\t\tconst posts = uni.getStorageSync('posts') || [];\r\n\t\t\t\t// 预设 title 为 content 的前20字\r\n\t\t\t\tif (!this.newPost.title) {\r\n\t\t\t\t\tthis.newPost.title = this.newPost.content\r\n\t\t\t\t\t\t.trim()\r\n\t\t\t\t\t\t.slice(0, 20);\r\n\t\t\t\t}\r\n\t\t\t\tposts.unshift({\r\n\t\t\t\t\t...this.newPost\r\n\t\t\t\t});\r\n\t\t\t\tuni.setStorageSync('posts', posts);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '发布成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.publish-container {\r\n\t\tflex: 1;\r\n\t\tbackground: #f5f5f5;\r\n\t\tposition: relative;\r\n\t\theight: 100vh;\r\n\t}\r\n\r\n\t.header {\r\n\t\tpadding-top: calc(var(--status-bar-height) + 40px);\r\n\t\tpadding-bottom: 10px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tposition: relative;\r\n\t\ttext-align: center;\r\n\t\tbackground-color: #f5f5f5;\r\n\t}\r\n\t\r\n\t.back-btn {\r\n\t\twidth: 20px;\r\n\t\theight: 20px;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.header-empty {\r\n\t\twidth: 50px;\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t.header-title {\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.publish-section {\r\n\t\tpadding: 10px 0;\r\n\t\tbackground: #fff;\r\n\t\theight: calc(100vh - var(--status-bar-height) - 60px);\r\n\t\tmargin: 2px 0px;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.publish-title {\r\n\t\theight: 36px;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 0 8px;\r\n\t\tmargin-bottom: 8px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.publish-input {\r\n\t\tmin-height: 80px;\r\n\t\tborder-radius: 4px;\r\n\t\tpadding: 8px;\r\n\t\tbox-sizing: border-box;\r\n\t\tfont-size: 14px;\r\n\t}\r\n\r\n\t.image-picker {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\tmargin: 8px;\r\n\t}\r\n\r\n\t.picked-image-wrapper {\r\n\t\tposition: relative;\r\n\t\twidth: 60px;\r\n\t\theight: 60px;\r\n\t\tmargin-right: 8px;\r\n\t\tmargin-bottom: 8px;\r\n\t\tborder-radius: 4px;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.picked-image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tobject-fit: cover;\r\n\t}\r\n\r\n\t.remove-btn {\r\n\t\tposition: absolute;\r\n\t\ttop: 2px;\r\n\t\tright: 2px;\r\n\t\tbackground: rgba(0, 0, 0, 0.5);\r\n\t\tcolor: #fff;\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tline-height: 16px;\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 8px;\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.add-image-btn {\r\n\t\twidth: 60px;\r\n\t\theight: 60px;\r\n\t\tmargin-right: 8px;\r\n\t\tmargin-bottom: 8px;\r\n\t\tborder: 1px dashed #ccc;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 24px;\r\n\t\tcolor: #999;\r\n\t\tborder-radius: 4px;\r\n\t}\r\n\r\n\t.publish-btn {\r\n\t\twidth: 70%;\r\n\t\theight: 40px;\r\n\t\tborder-radius: 15px;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 16px;\r\n\t\ttext-align: center;\r\n\t\tposition: fixed;\r\n\t\tbottom: 15px;\r\n\t\tleft: 15%;\r\n\t\t\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/GitProject/uniappWardrobe/pages/publishPost/publishPost.vue'\nwx.createPage(MiniProgramPage)"],"names":["themes","uni"],"mappings":";;;;AA2CC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,SAAS;AAAA,QACR,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,SAAS;AAAA,QACT,QAAQ,CAAE;AAAA,QACV,WAAW;AAAA,QACX,cAAc;AAAA,QACd,OAAO;AAAA,QACP,WAAW;AAAA,MACX;AAAA,MACD,OAAOA,iBAAM,OAAC,CAAC;AAAA,cACfA,iBAAK;AAAA;EAEN;AAAA,EACD,SAAS;AACR,SAAK,QAAQC,cAAAA,MAAI,eAAe,OAAO,KAAK,KAAK,OAAO,CAAC;AAEzD,UAAM,UAAUA,cAAG,MAAC,eAAe,aAAa,KAAK,CAAA;AACrD,SAAK,QAAQ,SAAS,QAAQ,UAAU;AAAA,EACxC;AAAA,EACD,SAAS;AAAA,IACR,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IAChB;AAAA,IACD,cAAc;AACbA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO,IAAI,KAAK,QAAQ,OAAO;AAAA,QAC/B,SAAS,CAAC,QAAQ;AACjB,eAAK,QAAQ,OAAO,KAAK,GAAG,IAAI,aAAa;AAAA,QAC9C;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IACD,YAAY,OAAO;AAClB,WAAK,QAAQ,OAAO,OAAO,OAAO,CAAC;AAAA,IACnC;AAAA,IACD,cAAc;AACb,UAAI,CAAC,KAAK,QAAQ,QAAQ,KAAI,KAAM,KAAK,QAAQ,OAAO,WAAW,GAAG;AACrEA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AACD;AAAA,MACD;AAEA,WAAK,QAAQ,KAAK,KAAK,IAAG,EAAG;AAC7B,YAAM,QAAQA,cAAG,MAAC,eAAe,OAAO,KAAK,CAAA;AAE7C,UAAI,CAAC,KAAK,QAAQ,OAAO;AACxB,aAAK,QAAQ,QAAQ,KAAK,QAAQ,QAChC,KAAK,EACL,MAAM,GAAG,EAAE;AAAA,MACd;AACA,YAAM,QAAQ;AAAA,QACb,GAAG,KAAK;AAAA,MACT,CAAC;AACDA,oBAAAA,MAAI,eAAe,SAAS,KAAK;AACjCA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AACDA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;AC7GF,GAAG,WAAW,eAAe;"}