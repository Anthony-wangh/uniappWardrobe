{"version":3,"file":"PostDetail.js","sources":["pages/community/PostDetail.vue","D:/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tbXVuaXR5L1Bvc3REZXRhaWwudnVl"],"sourcesContent":["<!-- PostDetail.vue -->\r\n<template>\r\n\t<view class=\"detail-container\">\r\n\t\t<!-- Header -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<image class=\"back-btn\" src=\"/static/back.png\" @click=\"goBack\">‚Äπ</image>\r\n\t\t\t<image :src=\"post.avatar\" class=\"avatar\" mode=\"aspectFill\" />\r\n\t\t\t<text class=\"username\">{{ post.user }}</text>\r\n\t\t\t<text class=\"follow-btn\" @click=\"toggleFollow\">{{ followed ? 'Â∑≤ÂÖ≥Ê≥®' : '+ÂÖ≥Ê≥®' }}</text>\r\n\t\t</view>\r\n\r\n\r\n\r\n\t\t<!-- Content -->\r\n\t\t<scroll-view class=\"content-wrap\" scroll-y @scroll=\"onScroll\">\r\n\t\t\t<!-- Image Carousel -->\r\n\t\t\t<swiper class=\"image-swiper\" :indicator-dots=\"true\" :autoplay=\"false\" :indicator-color=\"'#fff'\"\r\n\t\t\t\t:indicator-active-color=\"theme.primaryColor\" @change=\"onSwipeChange\">\r\n\t\t\t\t<swiper-item v-for=\"(img, idx) in post.images\" :key=\"idx\">\r\n\t\t\t\t\t<image :src=\"img\" mode=\"aspectFill\" class=\"swiper-image\" @click=\"previewImage(idx)\" />\r\n\t\t\t\t</swiper-item>\r\n\t\t\t</swiper>\r\n\t\t\t<!-- Title & Like Inline -->\r\n\t\t\t<view class=\"text-content-row\" v-if=\"post.title\">\r\n\t\t\t\t<text class=\"post-title\">{{ post.title }}</text>\r\n\t\t\t\t<view class=\"like-action-inline\" @click=\"toggleLike\">\r\n\t\t\t\t\t<text>{{ liked ? '‚ù§Ô∏è' : 'ü§ç' }}</text>\r\n\t\t\t\t\t<text class=\"like-count\">{{ likeCount }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- Post Content -->\r\n\t\t\t<view class=\"text-content\">\r\n\t\t\t\t<text class=\"post-text\">{{ post.content }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<text class=\"time\">{{ formattedTime }}</text>\r\n\r\n\t\t\t<!-- Action Bar -->\r\n\t\t\t<view class=\"action-bar\">\r\n\t\t\t\t<view class=\"comment-action\">\r\n\t\t\t\t\t<text class=\"comment-action-text\" @click=\"openPopup('comment')\">ËØ¥ÁÇπ‰ªÄ‰πà...</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- Separator -->\r\n\t\t\t<view class=\"sep\"></view>\r\n\t\t\t<text class=\"postCount-text\">ÂÖ±{{ post.commentCount }}Êù°ËØÑËÆ∫</text>\r\n\r\n\t\t\t<!-- Comments -->\r\n\t\t\t<view class=\"comments-section\">\r\n\t\t\t\t<view v-for=\"(comment, idx) in post.comments\" :key=\"idx\" class=\"comment-item\">\r\n\t\t\t\t\t<view class=\"c-body\">\r\n\t\t\t\t\t\t<view class=\"c-header\">\r\n\t\t\t\t\t\t\t<text class=\"c-user\">{{ comment.user }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<text class=\"c-text\">{{ comment.content }}</text>\r\n\t\t\t\t\t\t<text class=\"c-time\">{{ formatTime(comment.time) }}</text>\r\n\t\t\t\t\t\t<text class=\"c-reply\" @click=\"openPopup('reply', comment, idx)\">ÂõûÂ§ç</text>\r\n\r\n\t\t\t\t\t\t<view v-if=\"comment.replies\" class=\"replies\">\r\n\t\t\t\t\t\t\t<view v-for=\"(reply, rIdx) in comment.replies\" :key=\"rIdx\" class=\"reply-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"reply-text\"><text\r\n\t\t\t\t\t\t\t\t\t\tclass=\"c-user\">{{ reply.user }}</text>Ôºö{{ reply.content }}</text>\r\n\t\t\t\t\t\t\t\t<text class=\"c-time\">{{ formatTime(reply.time) }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\r\n\t\t<!-- Comment Popup -->\r\n\t\t<comment-input-popup :visible=\"popupVisible\" @update:visible=\"popupVisible = $event\"\r\n\t\t\t@submit=\"handlePopupSubmit\" />\r\n\t</view>\r\n</template>\r\n\r\n\r\n<script>\r\n\timport {\r\n\t\tthemes\r\n\t} from '@/components/theme.js';\r\n\timport CommentInputPopup from '@/components/CommentInputPopup.vue';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tCommentInputPopup\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpost: {\r\n\t\t\t\t\timages: [],\r\n\t\t\t\t\tuser: '',\r\n\t\t\t\t\tavatar: '',\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: '',\r\n\t\t\t\t\tcomments: [],\r\n\t\t\t\t\tcommentCount: 0\r\n\t\t\t\t},\r\n\t\t\t\tliked: false,\r\n\t\t\t\tlikeCount: 0,\r\n\t\t\t\tfollowed: false,\r\n\t\t\t\ttheme: themes[0],\r\n\t\t\t\tpopupVisible: false,\r\n\t\t\t\tpopupMode: 'comment', // 'comment' or 'reply'\r\n\t\t\t\ttargetComment: null,\r\n\t\t\t\ttargetIndex: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tformattedTime() {\r\n\t\t\t\treturn new Date().toLocaleString();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\tonLoad({\r\n\t\t\tid\r\n\t\t}) {\r\n\t\t\tthis.theme = uni.getStorageSync('theme') || themes[0];\r\n\t\t\tconst all = uni.getStorageSync('posts') || [];\r\n\t\t\tconst p = all.find(x => x.id === id);\r\n\t\t\tif (p) {\r\n\t\t\t\tthis.post = p;\r\n\t\t\t\tthis.liked = p.liked;\r\n\t\t\t\tthis.likeCount = p.likeCount;\r\n\t\t\t\tthis.followed = p.followed;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t},\r\n\t\t\tonSwipeChange() {},\r\n\t\t\tpreviewImage(idx) {\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\turls: this.post.images,\r\n\t\t\t\t\tcurrent: this.post.images[idx]\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttoggleLike() {\r\n\t\t\t\tthis.liked = !this.liked;\r\n\t\t\t\tthis.likeCount += this.liked ? 1 : -1;\r\n\t\t\t\tthis.syncStorage();\r\n\t\t\t},\r\n\t\t\tsharePost() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: 'ÂàÜ‰∫´ÂäüËÉΩÂæÖÂÆûÁé∞',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\ttoggleFollow() {\r\n\t\t\t\tthis.followed = !this.followed;\r\n\t\t\t\tthis.syncStorage();\r\n\t\t\t},\r\n\t\t\tformatTime(ts) {\r\n\t\t\t\tconst d = new Date(ts);\r\n\t\t\t\treturn `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${d.getMinutes()}`;\r\n\t\t\t},\r\n\t\t\topenPopup(mode, comment = null, idx = null) {\r\n\t\t\t\tthis.popupMode = mode;\r\n\t\t\t\tthis.targetComment = comment;\r\n\t\t\t\tthis.targetIndex = idx;\r\n\t\t\t\tthis.popupVisible = true;\r\n\t\t\t},\r\n\t\t\thandlePopupSubmit(text) {\r\n\t\t\t\tconst userProfile = uni.getStorageSync('userProfile') || {};\r\n\t\t\t\tconst obj = {\r\n\t\t\t\t\tuser: 'Êàë',\r\n\t\t\t\t\tavatar: userProfile.avatar || '',\r\n\t\t\t\t\tcontent: text,\r\n\t\t\t\t\ttime: Date.now()\r\n\t\t\t\t};\r\n\t\t\t\tif (this.popupMode === 'reply' && this.targetIndex !== null) {\r\n\t\t\t\t\tif (!this.post.comments[this.targetIndex].replies) {\r\n\t\t\t\t\t\tthis.$set(this.post.comments[this.targetIndex], 'replies', []);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.post.comments[this.targetIndex].replies.push(obj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!this.post.comments)\r\n\t\t\t\t\t\tthis.post.comments = [];\r\n\r\n\t\t\t\t\tthis.post.comments.unshift(obj);\r\n\t\t\t\t\tthis.post.commentCount++;\r\n\t\t\t\t}\r\n\t\t\t\tthis.syncPosts();\r\n\t\t\t},\r\n\t\t\tsyncStorage() {\r\n\t\t\t\tconst posts = uni.getStorageSync('posts') || [];\r\n\t\t\t\tconst idx = posts.findIndex(x => x.id === this.post.id);\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\tposts[idx].liked = this.liked;\r\n\t\t\t\t\tposts[idx].likeCount = this.likeCount;\r\n\t\t\t\t\tposts[idx].followed = this.followed;\r\n\t\t\t\t\tuni.setStorageSync('posts', posts);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsyncPosts() {\r\n\t\t\t\tconst posts = uni.getStorageSync('posts') || [];\r\n\t\t\t\tconst idx = posts.findIndex(x => x.id === this.post.id);\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\tposts[idx] = this.post;\r\n\t\t\t\t\tuni.setStorageSync('posts', posts);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.detail-container {\r\n\t\theight: 100vh;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbackground-color: #f7f7f7;\r\n\t}\r\n\r\n\t.header {\r\n\t\tbackground-color: #ffffff;\r\n\t\tbox-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);\r\n\t\tpadding-top: calc(var(--status-bar-height) + 30px);\r\n\t\tpadding-bottom: 10px;\r\n\t\theight: 40px;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\t\r\n\t\tborder-bottom: #888 solid 1px;\r\n\t}\r\n\r\n\t.back-btn {\r\n\t\twidth: 20px;\r\n\t\theight: 20px;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.avatar {\r\n\t\twidth: 40px;\r\n\t\theight: 40px;\r\n\t\tborder-radius: 20px;\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.username {\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-left: 5px;\r\n\t\tcolor: #272727;\r\n\t}\r\n\r\n\t.follow-btn {\r\n\t\tfont-size: 14px;\r\n\t\tpadding: 4px 10px;\r\n\t\tborder: 1px solid #4b5bb4;\r\n\t\tborder-radius: 8px;\r\n\t\tcolor: #4b5bb4;\r\n\t\tmargin-left: 20px;\r\n\t}\r\n\r\n\t.image-swiper {\r\n\t\twidth: 100%;\r\n\t\theight: 100vw;\r\n\t}\r\n\r\n\t.swiper-image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.content-wrap {\r\n\t\tpadding-bottom: 60px;\r\n\t\theight: calc(100vh - 130px);\r\n\t}\r\n\r\n\t.text-content {\r\n\t\tpadding: 5px 12px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\r\n\t.post-text {\r\n\t\tfont-size: 14px;\r\n\t\tline-height: 1.6;\r\n\t\tmargin-top: 6px;\r\n\t}\r\n\r\n\t.time {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #888;\r\n\t\tpadding: 5px 12px;\r\n\t}\r\n\r\n\t.action-bar {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tpadding: 12px 0;\r\n\t\tmargin: 10px;\r\n\t\tbackground: #e8e8e8;\r\n\t\tborder-radius: 20px;\r\n\t}\r\n\r\n\t.comment-action {\r\n\t\tmargin-left: 10px;\r\n\t}\r\n\r\n\t.comment-action-text {\r\n\t\tcolor: #888;\r\n\t}\r\n\r\n\t.like-action {\r\n\t\tmargin-left: 40%;\r\n\t}\r\n\r\n\r\n\r\n\t.sep {\r\n\t\theight: 8px;\r\n\t\tbackground: #f5f5f5;\r\n\t}\r\n\r\n\t.postCount-text {\r\n\t\tfont-size: 16px;\r\n\t\tpadding: 0 12px;\r\n\t\tmargin: 10px 0;\r\n\t}\r\n\r\n\t.comments-section {\r\n\t\tpadding: 8px 10px;\r\n\t}\r\n\r\n\t.comment-item {\r\n\t\tdisplay: flex;\r\n\t\tmargin-bottom: 12px;\r\n\t}\r\n\r\n\t.c-body {\r\n\t\tflex: 1;\r\n\t\tmargin: 10px;\r\n\t}\r\n\r\n\t.c-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.c-user {\r\n\t\tfont-size: 14px;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.c-text {\r\n\t\tfont-size: 14px;\r\n\t\tmargin: 4px 0;\r\n\t\tcolor: #4b4b4b;\r\n\t}\r\n\r\n\t.c-time {\r\n\t\tfont-size: 10px;\r\n\t\tcolor: #888;\r\n\t\tmargin-left: 5px;\r\n\t}\r\n\r\n\t.c-reply {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #4b5bb4;\r\n\t\tmargin-left: 5px;\r\n\t}\r\n\r\n\t.replies {\r\n\t\tmargin-top: 8px;\r\n\t\tpadding-left: 20px;\r\n\t}\r\n\r\n\t.reply-item {\r\n\t\tmargin-bottom: 6px;\r\n\t}\r\n\r\n\t.reply-text {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #707070;\r\n\t}\r\n\r\n\r\n\r\n\t.text-content-row {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tpadding: 10px 12px 0 12px;\r\n\t}\r\n\r\n\t.post-title {\r\n\t\tfont-size: 18px;\r\n\t\tfont-weight: bold;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.like-action-inline {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t.like-count {\r\n\t\tmargin-left: 4px;\r\n\t\tfont-size: 14px;\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/GitProject/uniappWardrobe/pages/community/PostDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["themes","uni"],"mappings":";;;;AAmFC,MAAO,oBAAmB,MAAW;AACrC,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA,QACL,QAAQ,CAAE;AAAA,QACV,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,SAAS;AAAA,QACT,UAAU,CAAE;AAAA,QACZ,cAAc;AAAA,MACd;AAAA,MACD,OAAO;AAAA,MACP,WAAW;AAAA,MACX,UAAU;AAAA,MACV,OAAOA,iBAAM,OAAC,CAAC;AAAA,MACf,cAAc;AAAA,MACd,WAAW;AAAA;AAAA,MACX,eAAe;AAAA,MACf,aAAa;AAAA;EAEd;AAAA,EACD,UAAU;AAAA,IACT,gBAAgB;AACf,cAAO,oBAAI,QAAO;IACnB;AAAA,EACA;AAAA,EAGD,OAAO;AAAA,IACN;AAAA,EACD,GAAG;AACF,SAAK,QAAQC,oBAAI,eAAe,OAAO,KAAKD,iBAAAA,OAAO,CAAC;AACpD,UAAM,MAAMC,cAAG,MAAC,eAAe,OAAO,KAAK,CAAA;AAC3C,UAAM,IAAI,IAAI,KAAK,OAAK,EAAE,OAAO,EAAE;AACnC,QAAI,GAAG;AACN,WAAK,OAAO;AACZ,WAAK,QAAQ,EAAE;AACf,WAAK,YAAY,EAAE;AACnB,WAAK,WAAW,EAAE;AAAA,IACnB;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IAChB;AAAA,IACD,gBAAgB;AAAA,IAAE;AAAA,IAClB,aAAa,KAAK;AACjBA,oBAAAA,MAAI,aAAa;AAAA,QAChB,MAAM,KAAK,KAAK;AAAA,QAChB,SAAS,KAAK,KAAK,OAAO,GAAG;AAAA,MAC9B,CAAC;AAAA,IACD;AAAA,IACD,aAAa;AACZ,WAAK,QAAQ,CAAC,KAAK;AACnB,WAAK,aAAa,KAAK,QAAQ,IAAI;AACnC,WAAK,YAAW;AAAA,IAChB;AAAA,IACD,YAAY;AACXA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AAAA,IACD;AAAA,IAED,eAAe;AACd,WAAK,WAAW,CAAC,KAAK;AACtB,WAAK,YAAW;AAAA,IAChB;AAAA,IACD,WAAW,IAAI;AACd,YAAM,IAAI,IAAI,KAAK,EAAE;AACrB,aAAO,GAAG,EAAE,SAAQ,IAAG,CAAC,IAAI,EAAE,QAAO,CAAE,IAAI,EAAE,UAAU,IAAI,EAAE,WAAY,CAAA;AAAA,IACzE;AAAA,IACD,UAAU,MAAM,UAAU,MAAM,MAAM,MAAM;AAC3C,WAAK,YAAY;AACjB,WAAK,gBAAgB;AACrB,WAAK,cAAc;AACnB,WAAK,eAAe;AAAA,IACpB;AAAA,IACD,kBAAkB,MAAM;AACvB,YAAM,cAAcA,cAAG,MAAC,eAAe,aAAa,KAAK,CAAA;AACzD,YAAM,MAAM;AAAA,QACX,MAAM;AAAA,QACN,QAAQ,YAAY,UAAU;AAAA,QAC9B,SAAS;AAAA,QACT,MAAM,KAAK,IAAI;AAAA;AAEhB,UAAI,KAAK,cAAc,WAAW,KAAK,gBAAgB,MAAM;AAC5D,YAAI,CAAC,KAAK,KAAK,SAAS,KAAK,WAAW,EAAE,SAAS;AAClD,eAAK,KAAK,KAAK,KAAK,SAAS,KAAK,WAAW,GAAG,WAAW,CAAA,CAAE;AAAA,QAC9D;AACA,aAAK,KAAK,SAAS,KAAK,WAAW,EAAE,QAAQ,KAAK,GAAG;AAAA,aAC/C;AACN,YAAI,CAAC,KAAK,KAAK;AACd,eAAK,KAAK,WAAW;AAEtB,aAAK,KAAK,SAAS,QAAQ,GAAG;AAC9B,aAAK,KAAK;AAAA,MACX;AACA,WAAK,UAAS;AAAA,IACd;AAAA,IACD,cAAc;AACb,YAAM,QAAQA,cAAG,MAAC,eAAe,OAAO,KAAK,CAAA;AAC7C,YAAM,MAAM,MAAM,UAAU,OAAK,EAAE,OAAO,KAAK,KAAK,EAAE;AACtD,UAAI,QAAQ,IAAI;AACf,cAAM,GAAG,EAAE,QAAQ,KAAK;AACxB,cAAM,GAAG,EAAE,YAAY,KAAK;AAC5B,cAAM,GAAG,EAAE,WAAW,KAAK;AAC3BA,sBAAAA,MAAI,eAAe,SAAS,KAAK;AAAA,MAClC;AAAA,IACA;AAAA,IACD,YAAY;AACX,YAAM,QAAQA,cAAG,MAAC,eAAe,OAAO,KAAK,CAAA;AAC7C,YAAM,MAAM,MAAM,UAAU,OAAK,EAAE,OAAO,KAAK,KAAK,EAAE;AACtD,UAAI,QAAQ,IAAI;AACf,cAAM,GAAG,IAAI,KAAK;AAClBA,sBAAAA,MAAI,eAAe,SAAS,KAAK;AAAA,MAClC;AAAA,IACD;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7MF,GAAG,WAAW,eAAe;"}