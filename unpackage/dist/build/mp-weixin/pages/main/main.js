"use strict";const e=require("../../common/vendor.js"),t=require("../../components/theme.js"),a={data:()=>({nickName:"帅哥",usingDate:99,weatherInfo:{},clothingAdvice:{},weatherDetail:"",weatherTips:"",weatherIcon:"",theme:t.themes[0],themes:t.themes,banners:["/static/banners/banner1.jpeg","/static/banners/banner2.jpeg","/static/banners/banner3.jpeg","/static/banners/banner4.jpeg"]}),onShow(){const t=e.index.getStorageSync("theme")||this.themes[0];this.theme=t,this.getWeather()},methods:{isToday(e){const[t,a,s]=e.split("-").map(Number),r=new Date(t,a-1,s),n=new Date;return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()&&r.getDate()===n.getDate()},async getWeather(){const t=e.index.getStorageSync("weatherInfo");if(t&&this.isToday(t.fxDate))return this.weatherInfo=t,void this.updateWeather(t);e.index.getLocation({type:"wgs84",success:t=>{const a=`${t.longitude},${t.latitude}`;e.wx$1.request({url:"https://nd3tefcedt.re.qweatherapi.com/v7/weather/3d",data:{location:a,key:"38c34a465f6f4afa9e15de9954fc542c"},success:({data:t})=>{const a=t.daily[0];e.index.setStorageSync("weatherInfo",a),this.weatherInfo=a,this.updateWeather(a)},fail:e=>console.error("获取天气失败:",e)})},fail:e=>console.error("获取位置失败:",e)})},updateWeather(e){const t=`${e.textDay}  ${e.tempMin}℃ ~ ${e.tempMax}℃`,a=`${e.windDirDay} ${e.windScaleDay}级 紫外线: ${e.uvIndex}`;this.weatherDetail=`${t}\n${a}`,this.weatherIcon=`/static/weather_icons/${e.textDay}.png`,this.clothingAdvice=this.getClothingAdvice(e),this.weatherTips=this.clothingAdvice.summary},getClothingAdvice(e){const t=parseInt(e.tempMax),a=parseInt(e.tempMin),s=(t+a)/2,r=t-a,n=[{max:-10,level:"extremeCold",name:"极寒"},{max:0,level:"severeCold",name:"严寒"},{max:10,level:"cold",name:"寒冷"},{max:16,level:"chilly",name:"微寒"},{max:22,level:"cool",name:"凉爽"},{max:28,level:"comfortable",name:"舒适"},{max:32,level:"warm",name:"炎热"},{max:1/0,level:"hot",name:"酷热"}].find((e=>s<=e.max)),o={level:n.name,upper:[],lower:[],accessories:[],tips:[],specialNotes:[]};switch(n.level){case"extremeCold":o.upper=["加厚羽绒服","高领羊毛衫"],o.lower=["加绒棉裤"],o.accessories=["毛线帽","围巾"],o.tips.push("注意保暖");break;case"severeCold":o.upper=["长款羽绒服","毛衣+大衣"],o.lower=["保暖打底裤"],o.accessories=["针织帽"];break;case"cold":o.upper=["短款羽绒服","厚卫衣"],o.lower=["加绒牛仔裤"],o.accessories=["薄围巾"];break;case"chilly":o.upper=["风衣","薄毛衣"],o.lower=["休闲裤"],o.accessories=["便携外套"];break;case"cool":o.upper=["长袖衬衫","薄外套"],o.lower=["薄款牛仔裤"],o.accessories=["丝巾"],o.tips.push("适合叠穿");break;case"comfortable":o.upper=["短袖T恤","POLO衫"],o.lower=["九分裤"],o.accessories=["防晒衣"];break;case"warm":o.upper=["透气短袖","雪纺上衣"],o.lower=["短裤"],o.accessories=["遮阳帽"],o.tips.push("选透气面料");break;case"hot":o.upper=["无袖上衣","真丝衬衫"],o.lower=["凉感裙装"],o.accessories=["防晒伞"],o.tips.push("避免正午外出")}e.textDay.includes("雨")&&(o.accessories.push("雨伞"),parseInt(e.windScaleDay)>3&&o.specialNotes.push("风雨较大，穿防滑鞋")),parseInt(e.windScaleDay)>=4&&o.specialNotes.push("注意防风"),r>8&&o.specialNotes.push(`昼夜温差${r}℃，建议洋葱式穿搭`);const i=[];return o.upper.length&&i.push(`- 上衣：${o.upper.join(" / ")}`),o.lower.length&&i.push(`- 下装：${o.lower.join(" / ")}`),o.accessories.length&&i.push(`- 配饰：${o.accessories.join("、")}`),o.specialNotes.length&&i.push(`- 注意：${o.specialNotes.join("；")}`),o.tips.length&&i.push(`- 小贴士：${o.tips.join("；")}`),o.summary=`天气${o.level}\n${i.join("\n")}`,o}}};const s=e._export_sfc(a,[["render",function(t,a,s,r,n,o){return{a:e.f(n.banners,((e,t,a)=>({a:e,b:t}))),b:n.theme.textColor,c:n.theme.primaryColor,d:e.t(n.weatherDetail),e:e.t(n.weatherTips),f:`linear-gradient(135deg, ${n.theme.primaryColor}, ${n.theme.secondaryColor})`}}],["__scopeId","data-v-b44d89c4"]]);wx.createPage(s);
