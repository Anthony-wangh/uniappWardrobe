"use strict";const e=require("../../common/vendor.js"),t=require("../../components/theme.js"),s=require("../../common/assets.js"),o={components:{CommentInputPopup:()=>"../../components/CommentInputPopup.js"},data:()=>({posts:[],isPopupVisible:!1,currentPost:null,currentComment:null,theme:t.themes[0],themes:t.themes}),onShow(){const t=e.index.getStorageSync("theme")||this.themes[0];this.theme=t,this.posts=e.index.getStorageSync("posts")||[],this.posts.forEach((e=>{e.comments||(e.comments=[]),e.comments.forEach((e=>{e.replies||(e.replies=[])}))}))},methods:{goToPublish(){e.index.navigateTo({url:"/pages/publishPost/publishPost"})},toggleLike(t){t.liked=!t.liked,t.likeCount+=t.liked?1:-1,e.index.setStorageSync("posts",this.posts)},openComment(e){this.currentPost=e,this.currentComment=null,this.isPopupVisible=!0},openReply(e,t){this.currentPost=e,this.currentComment=t,this.isPopupVisible=!0},handlePopupSubmit(t){t&&(this.currentPost.comments||this.$set(this.currentPost,"comments",[]),this.currentComment?(this.currentComment.replies||this.$set(this.currentComment,"replies",[]),this.currentComment.replies.push({user:"我",content:t})):this.currentPost.comments.push({user:"我",content:t,replies:[]}),e.index.setStorageSync("posts",this.posts),this.isPopupVisible=!1,this.currentPost=null,this.currentComment=null)},previewImages(t,s){e.index.previewImage({urls:t,current:t[s]})}}};if(!Array){e.resolveComponent("comment-input-popup")()}const n=e._export_sfc(o,[["render",function(t,o,n,i,r,m){return{a:r.theme.textColor,b:`linear-gradient(135deg, ${r.theme.primaryColor}, ${r.theme.secondaryColor})`,c:e.f(r.posts,((t,s,o)=>({a:e.t(t.user),b:e.t(t.content),c:e.f(t.images.slice(0,9),((s,o,n)=>({a:s,b:o,c:e.o((e=>m.previewImages(t.images,o)),o)}))),d:e.f(t.comments,((s,o,n)=>({a:e.t(s.user),b:e.t(s.content),c:e.o((e=>m.openReply(t,s)),o),d:e.f(s.replies,((t,s,o)=>({a:e.t(t.user),b:e.t(t.content),c:s}))),e:e.t(s.user),f:o}))),e:e.t(t.liked?"❤️":"🤍"),f:e.t(t.likeCount),g:e.o((e=>m.toggleLike(t)),s),h:e.o((e=>m.openComment(t)),s),i:s}))),d:s._imports_0$3,e:e.o(m.handlePopupSubmit),f:e.o((e=>r.isPopupVisible=!1)),g:e.p({visible:r.isPopupVisible}),h:s._imports_1$1,i:e.o(((...e)=>m.goToPublish&&m.goToPublish(...e))),j:r.theme.secondaryColor}}],["__scopeId","data-v-417650a4"]]);wx.createPage(n);
